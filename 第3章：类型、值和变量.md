# 3.2 数值



## 1. 整数字面量

下面是十六进制整数字面量的例子：

```javascript
0xff // => 255：（15*16 + 15）

0xBADCAFE // => 195939070
```



在 ES6 及之后的版本中，也可以通过二进制（基数为 2）或八进制（基数为 8）表示整数，分别使用前缀 0b 和 0o（或 0B 和 0O）：

```javascript
0b10101 // => 21：（1 * 16 + 0 * 8 + 1 * 4 + 0 * 2 + 1 * 1）

0o377 // => 255：（3 * 64 + 7 * 8 + 7 * 1）
```



## 2. 浮点字面量

```javascript
3.14
2345.679
.3333333333333333333
6.02e23 
1.4738223-32
```



数值字面量中的分隔符

```javascript
lexxxxxxxxxxxxxxxx
```

 

## 3. JavaScript 中的算术

JavaScript 预定义了全局常量 Infinity 和 NaN 以对正无穷和非数值。这些值也可以通过 Number 对象的属性获取：

```javascript
Infinity                 // 因为太大而无法表示的正数
Number.POSITIVE_INFINITY // 同上
1/0 // => Infinity
Number.MAX_VALUE * 2 // => Infinity
-Infinity // 因为太大而无法表示的负数
Number.NEGATIVE_INFINITY // 同上
-1/0 // => -Infinity
-Number.MAX_VALUE * 2 // => -Infinity

NaN // 非数值
Number.NaN // 同上，写法不同
0/0 // => NaN
Infinity/Infinity // => NaN

Number.MIN_VALUE/2 // => 0: 下溢出
-Number.MIN_VALUE/2 // => -0：负零
-1/Infinity // =>-0：也是负零
-0

// ES6 定义了下列 Number 属性
Number.parseInt() // 同全局 parseInt() 函数
Number.parseFloat() // 同全局 parseFloat() 函数
Number.isNaN(x) // 判断 x 是不是 NaN
Number.isFinite(x) // 判断 x 是数值还是无穷
Number.isInteger(x) // 判断 x 是不是整数
Number.isSafeInteger(x) 
Number.MIN_SAFE_INTEGER // => -(2**53 - 1)                                                                                       
Number.MAX_SAFE_INTEGER // => 2**53 - 1
Number.EPSILON 
```



## 4. 二进制浮点数与舍入错误



## 5. 通过 BigInt 表示任意精度整数

```javascript
1234n // 一个不太大的 BigInt 字面量
0b111111n // 二进制 BigInt
0o7777n // 八进制 BigInt
0x8000000000000000n // => 2n**63n：一个 64 位整数
```

可以把 BigInt() 函数把常规 JavaScript 数值或字符串转换成 BigInt 值：

```javascript
BigInt(Number.MAX_SAFE_INTEGER); // => 9007199254740991n
let string = "1" + "0".repeat(100); // 1 后跟 100 个零
BigInt(string); // 10n**100n：一个天文数字
```

BigInt 值的算术运算与常规 JavaScript 数值的算术运算类似，只不过除法会丢弃余数并且会向下（向零）舍入：

```javascript
1000n + 2000n // => 3000n
3000n - 2000n // => 1000n
2000n * 3000n // => 6000000n
3000n / 997n // => 3n：商是 3
3000n % 997n // => 9n：余数是 9
(2n ** 131071n) - 1n // 有 39457 位数字的梅森素数                                                                                  
```





# 3.3 文本

**`JavaScript 中表示文本的类型是 String，即是字符串。字符串是 16 位值得不可修改得有序序列，其中每个值都表示一个 Unicode 字符。字符串得 length 属性是它包含的 16 位值的个数。JavaScript 的字符串（以及数组）使用基于零的索引，因此第一个 16 位值的索引是 0，第二个值的索引是 1，以此类推。空字符串是长度为 0 的字符串。JavaScript 没有表示单个字符串元素的专门类型。要表示一个 16 位值，使用长度为 1 的字符串即可。`** 



## 1. 字符串字面量

```                                                                                                                                                                                                        javascript
""; // 空字符串，即有零个字符
'testing';
"3.14";
'name="myform"';
"Wouldn't you prefer O'Reilly's book?";
"t is the ratio of a circle's circumference to its radius";
`"She said 'hi'", he said.`;
```



**`JavaScript 最早的版本要求字符串字面量必须写在一行，使用 + 操作符把单行字符串拼接成长字符串的 JavaScript 代码随处可见。到了 ES5，我们可以在每行末尾加一个反斜杠（\）从而把字符串字面量写到多行上。这个反斜杠和它后面的行终结符都不属于字符串字面量。如果需要在单引号或双引号字符串中包含换行符，需要使用字符序列 \n。ES6 的反引号语法支持跨行字符串，而行终结符也是字符串字面量的一部分：`** 

```javascript
// 写在一行但表示两行的字符串：
'two\nlines';

// 写在三行但只有一行的字符串：
"one\
 long\
 line";

// 写在两行实际也是两行的字符串：
`the newline character at the end of this line
 is included literallyy in this string`;
```





## 3. 使用字符串

除了 length 属性之外，JavaScript 还提供了操作字符串的丰富 API：

```javascript
let s = "Hello, world"; // 先声明一个字符串

// 取得字符串的一部分
s.substring(1, 4); // => "ell"：第 2 ~ 4 个字符
s.slice(1, 4); // => "ell"：同上
s.slice(-3); // => "rld"：最后 3 个字符
s.split(', '); // => ["Hello", "world"]: 从定界符处拆开

// 搜索字符串
s.indexOf("l"); // => 2：第一个字母 l 的位置
s.indexOf("l", 3); // => 3：位置 3 后面第一个 "l" 的位置
s.indexOf("zz"); // => -1：s 并不包括子串 "zz"
s.lastIndexOf("l"); // => 10：最后一个字母 l 的位置

// ES6 及以后版本中的布尔值搜索函数
s.startWith("Hell") // => true：字符串是以这些字符开头的
s.endWith("!"); // => false：s 不是以它结尾的
s.includes("or"); // true：s 包含字串 "or"

// 创建字符串的修改版本
s.replace("llo", "ya"); // => "Heya, world"
s.toLowerCase() // => "hello, world"
s.toUpperCase() // => "HELLO, WORLD"
s.normalize();  // Unicode NFC 归一化：ES6 新增
s.normalize("NFD"); // NFD 归一化。还有 "NFKC" 和 "NFKD"

// 访问字符串中的个别（16 位值）字符                
s.charAt(0); // => "H": 第一个字符
s.charAt(s.length - 1); // => "d": 最后一个字符
s.charCodeAt(0); // => 72: 指定位置的 16 位数值
s.codePointAt(0); // => 72: ES6, 适用于码点大于 16 位的情形                                                                           

// ES2017 新增的字符串填充函数
"x".padStart(3); 	  // => "  x": 在左侧添加空格，让字符串长度变成 3
"x".padEnd(3);        // => "x  ": 在右侧添加空格，让字符串长度变成 3
"x".padStart(3, "*")  // => "**x": 在左侧添加星号，让字符串长度变成 3
"x".padEnd(3, "-")    // => "x--"：在右侧添加破折号，让字符串长度变成 3

// 删除空格函数。trim() 是 ES5 就有的，其他是 ES2019 增加的
"test  ".trim();        // => "test": 删除开头和末尾的空格
"  test  ".trimStart(); // => "test  ": 删除左侧空格。也叫 trimLeft
"  test  ".trimEnd();   // => "  test": 删除右侧空格。也叫 trimRight

// 未分类字符串方法
s.concat("!");  // => "Hello, world!": 可以用 + 操作符代替
"<>".repeat(5); // => "<><><><><>": 拼接 n 次。ES6 新增                                                                  
```



字符串也可以被当成只读数组，使用方括号而非 charAt() 方法访问字符串中个别的字符（16 位值）：

```                                                                                                                         javascript
let s = "hello, world";
s[0];            // => "h"
s[s.length - 1]; // => "d"
```





## 5. 模式匹配

```javascript
/^HTML/; // 匹配字符串开头的字母 HTML
/[1-9][0-9]*/; // 匹配非 0 数字，后面跟着任意数字
/\bjavascript\b/i; // 匹配 "javascript" 这个词，不区分大小写             
```



RegExp 对象定义了一些有用的方法，而字符串也有接收 RegExp 参数的方法。例如：

```javascript
let text = "testing: 1, 2, 3";
let pattern = /\d+/g;
pattern.test(text); // => true: 存在匹配项
text.search(pattern); // => 9: 第一个匹配项的位置
text.match(pattern); // => ["1", "2", "3"]: 所有匹配项的数组
text.replace(pattern, "#"); // => "testing: #, #, #"
text.split(/\D+/); // => ["", "1", "2", "3"]: 基于非数字拆分
```





# 3.6 符号

```javascript
let s = Symbol.for("shared");
let t = Symbol.for("shared");

s === t; // => true
s.toString(); // => "Symbol(shazzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz                                                                                                               red)"
Symbol.keyFor(t); // => "shared"
```







# 3.7 全局对象

* undefined、Infinity 和 NaN 
* isNaN()、parseInt()、eval()
* Date()、RegExp()、String()、Object() 和 Array() 
* Math 和 JSON



# 3.9 类型转换

看几个例子：

```javascript
10 + "objects" // => "10 objects": 数值 10 转换为字符串
"7" * "4" // => 28: 两个字符串都转换为数值
let n = 1 - "x"; // n 为 NaN: 字符串 "x" 无法转换为数值
n + " objects" // => "NaN objects": NaN 转换为字符串 "NaN"
```



| 值            | 转换为字符串     | 转换为数值 | 转换为布尔值 |
| ------------- | ---------------- | ---------- | ------------ |
| undefined     | "undefined"      | NaN        | false        |
| null          | "null"           | 0          | false        |
| true          | "true"           | 1          |              |
| false         | "false"          | 0          |              |
| ""            |                  | 0          | false        |
| "1.2"         |                  | 1.2        | true         |
| "one"         |                  | NaN        | true         |
| 0             | "0"              |            | false        |
| -0            | "0"              |            | false        |
| 1             | "1"              |            | true         |
| Infinity      | "Infinity"       |            | true         |
| -Infinity     | "-Infinity"      |            | true         |
| NaN           | "NaN"            |            | false        |
| {}            |                  |            | true         |
| []            | ""               | 0          | true         |
| [9]           | "9"              | 9          | true         |
| ['a']         | 使用 join() 方法 | NaN        | true         |
| Function() {} |                  | NaN        | true         |



## 1. 转换与相等

```javascript
null == undefined // => true：这两个值被判定为相等                                   
"0" == 0 // => true: 字符串在比较前会转换为数值
0 == false // => true：布尔值在比较前会转换为数值
"0" == false // => true：两个操作数在比较前都转换为 0
```



## 2. 显式转换

```javascript
let n = 123456.789;

n.toFixed(0); // => "123457"
n.toFixed(2); // => "123456.79"
n.toFixed(5); // => "123456.78900"
n.toExponential(1); // => "1.2e+5"
n.toExponential(3); // => "1.235e+5"
n.toPrecision(4); // => "1.235e+5"
n.toPrecision(7); // => "123456.8"
n.toPrecision(10); // => "123456.7890"
```



```javascript
parseInt("3 blind mice"); // => 3
parseFloat(" 3.14 meters"); // => 3.14
parseInt("-12.34"); // => -12
parseInt("0xFF"); // => 255
parseInt("0xff"); // => 255
parseInt("-0XFF"); // => -255
parseFloat(".1"); // => 0.1
parseInt("0.1"); // => 0
parseInt(".1"); // => NaN：整数不能以 "." 开头
parseFloat("$72.47"); // => NaN：数值不能以 "$" 开头
```



parseInt() 接收可选的第二个参数，用于指定要解析数值的底数，合法的值是 2 到 36。例如：

```javascript
parseInt("11", 2); // => 3
parseInt("ff", 16); // => 255
parseInt("zz", 36); // => 1295
parseInt("077", 8); // => 63
parseInt("077", 10); // => 77
```



## 3. 对象到原始值转换

### 对象转换为布尔值

所有对象都转换为 true 



### toString() 和 valueOf() 方法

​                                                                                                                                                                                                                                                                                                                                                         第一个方法 toString() 的任务是返回对象的字符串表示。默认情况下，toString() 方法不会返回特别的值。

```javascript
({ x: 1, y: 2 }).toString(); // => "[object Object]"

[1,2,3].toString(); // => "1,2,3"
(function(x) { f(x); }).toString(); // => "function(x) { f(x); }"
/\d+/g.toString(); // "/\\d+/g"
let d = new Date(2020, 0, 1);
d.toString(); // => Wed Jan 01 2020 00:00:00 GMT-0800
```



第二个方法是 valueOf() 方法

```javascript
let d = new Date(2010, 0, 1);

d.valueOf() // => 1262275200000
```





### 对象到原始值转换算法

​      
